<button mat-stroked-button class="show-tiles pl-2 pr-2 ml-1 mr-1" (click)="show(dialog)" #myButton>
  <span class="name">{{name}}</span>
  <mat-icon>arrow_drop_down</mat-icon>
</button>

<!---->
<ng-template #dialog>
  <mat-dialog-content>
    <div class="container-fluid">
      <div class="row mb-1 align-items-center">
        <div class="col" ><h4>{{name}}</h4></div>
      </div>
    </div>
    <div *ngFor="let set of internalSelectionSets; index as setIndex">

      <div class="container-fluid">
        <div class="row mb-1 align-items-center">
          <div class="col" ><h4>{{set.name}}</h4></div>
          <div class="col-4 subHeading" *ngIf="set.maxSelections < set.selectionSet.length"><h5>Select up to {{set.maxSelections}}</h5></div>
        </div>
        <div class="row mb-1 p-1" *ngIf="(set.maxSelections == set.currentSelectedCount && set.maxSelections < set.selectionSet.length)">
          <div class="col">
            <!--
            <common-messaging  
              displayType="inpage"
              [message]="message"
            ></common-messaging>  
            -->
          </div>
        </div>
      </div>

      <div cdkDropList class="example-list" (cdkDropListDropped)="drop($event, setIndex)" *ngIf="set.sortable">
        <div class="example-box" *ngFor="let selection of set.selectionSet; index as i" cdkDrag>
          <div class="box">
            <div class="pr-1"><mat-icon>drag_indicator</mat-icon></div>
            <div><input type="checkbox" [disabled]="selection.disabled || (!selection.selected && set.currentSelectedCount == set.maxSelections)" [(ngModel)]="selection.selected" (ngModelChange)="onChecked(i, $event, setIndex)"></div>
            <div class="ml-2 selectionName">{{selection.name}}</div>
          </div>
          <div class="arrows">
            <a *ngIf="i !== 0 && (selection.selected || set.currentSelectedCount < set.maxSelections)" (click)="moveItemInArray(set.selectionSet,i,i-1)"><i class="fa fa-arrow-up"></i></a>
            <a *ngIf="i === 0 || (!selection.selected && set.currentSelectedCount >= set.maxSelections)"><i class="fa fa-arrow-up disabledIcon"></i></a>
            &nbsp;
            <a *ngIf="(i !== (set.selectionSet.length - 1)) && ((selection.selected && i < set.currentSelectedCount-1) || (set.currentSelectedCount < set.maxSelections))" (click)="moveItemInArray(set.selectionSet,i+1,i)"><i class="fa fa-arrow-down"></i></a>
            <a *ngIf="(i === (set.selectionSet.length - 1)) || ((!selection.selected || i >= set.currentSelectedCount-1) && set.currentSelectedCount >= set.maxSelections)"><i class="fa fa-arrow-down disabledIcon"></i></a>
            &nbsp;
          </div>
        </div>
      </div>
      <div *ngIf="!set.sortable">
        <div class="example-box" *ngFor="let selection of set.selectionSet; index as i">
          <div class="box">
            <div class="pr-3">&nbsp;&nbsp;&nbsp;</div>
            <div><input type="checkbox" [disabled]="selection.disabled || (!selection.selected && set.currentSelectedCount == set.maxSelections)" [(ngModel)]="selection.selected"></div>
            <div class="ml-1">{{selection.name}}</div>
          </div>
        </div>
      </div>
    </div>
  </mat-dialog-content>
  <hr>
  <mat-dialog-actions align="end">
    <button mat-button color="primary" (click)="save()">Save</button>
    <button mat-button color="primary" (click)="cancel()">Cancel</button>
  </mat-dialog-actions>
</ng-template>